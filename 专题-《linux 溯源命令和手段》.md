## 一、命令行工具

1. `history`命令：
   - 查看当前用户执行过的命令历史记录。这可以帮助你了解用户在系统上进行的操作。你可以使用`history`命令直接查看历史记录，也可以通过管道结合`grep`命令搜索特定的命令。例如：`history | grep "keyword"`，其中 “keyword” 是你要搜索的关键字。
2. `last`和`lastlog`命令：
   - `last`命令显示系统的登录记录，包括登录用户、登录时间、登录来源等信息。这对于确定是否有异常的登录行为非常有用。
   - `lastlog`命令显示系统中所有用户的最后一次登录时间。
3. `ps`和`top`命令：
   - `ps aux`命令列出当前系统中的所有进程及其详细信息，包括进程 ID、用户、CPU 和内存使用情况等。通过查看进程列表，你可以发现异常的进程，例如占用大量资源或由未知用户启动的进程。
   - `top`命令动态显示系统中最活跃的进程，提供实时的 CPU、内存和交换空间使用情况。它可以帮助你快速识别系统中的性能问题和异常进程。
4. `netstat`和`ss`命令：
   - `netstat -antp`命令显示当前系统的网络连接状态，包括监听端口、已建立的连接等，并显示相关的进程 ID 和程序名称。这对于检测可疑的网络连接非常有用。
   - `ss`命令是一个更快速的替代工具，可以提供类似的网络连接信息。
5. `lsof`命令：
   - `lsof`命令列出打开文件的进程。通过查看特定文件或端口的打开进程，你可以确定哪些进程正在访问特定的资源。例如，`lsof -i :port_number`可以列出正在使用特定端口的进程。

## 二、文件系统检查

1. 检查文件权限和所有权：
   - 使用`ls -l`命令查看文件和目录的权限和所有权。异常的权限设置或所有权变更可能是安全问题的迹象。确保重要文件和目录的权限设置正确，并且只有授权用户可以访问。
   - 检查`/etc/passwd`和`/etc/group`文件，确保用户和组的信息正确。
2. 检查关键文件的修改时间：
   - 对于关键系统文件，如`/etc/passwd`、`/etc/shadow`、`/etc/sudoers`等，可以使用`stat`命令查看它们的修改时间。如果这些文件的修改时间与你预期的不符，可能意味着系统被篡改。
3. 检查临时目录和日志文件：
   - `/tmp`和`/var/tmp`目录是临时文件存储的地方，可能会被恶意软件利用。检查这些目录中的文件，看是否有异常的文件存在。
   - 查看系统日志文件，如`/var/log/messages`、`/var/log/auth.log`、`/var/log/syslog`等，以获取关于系统活动的信息。日志文件可以提供有关登录尝试、服务启动和停止、错误消息等的线索。

## 三、安全工具

1. `auditd`：
   - Linux 审计系统可以记录系统中的各种事件，如文件访问、进程启动、系统调用等。通过配置和启用`auditd`，你可以收集详细的系统活动信息，并使用工具如`ausearch`和`aureport`进行分析和溯源。
2. 入侵检测系统（IDS）：
   - 安装和配置入侵检测系统，如`Snort`或`Suricata`，可以实时监测网络流量，检测潜在的攻击行为，并提供溯源信息。
3. 文件完整性检查工具：
   - 工具如`Tripwire`或`AIDE`可以监控文件系统的完整性，检测文件的修改、添加或删除。这些工具可以帮助你及时发现系统被篡改的情况，并提供溯源线索。

## 四、网络分析

1. 网络流量捕获：
   - 使用工具如`tcpdump`或`Wireshark`可以捕获网络流量，分析数据包以确定是否有可疑的通信。你可以根据特定的 IP 地址、端口号或协议进行过滤，以缩小分析范围。
2. 检查网络连接：
   - 使用`nmap`等网络扫描工具可以扫描系统的开放端口和服务，确定是否有未经授权的服务在运行。同时，检查网络连接状态，看是否有异常的连接到外部服务器。